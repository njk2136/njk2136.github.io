<html>
<!--- Start the Javascript that does all the hard work! --->

<script type="text/javascript" charset="UTF-8">



/************** Script by Wilma A. Bainbridge, 2016 ***********************



Updated August 26, 2020: Minor updates:

- Now records responses during fixation

- Fixed bug not showing "goodbye" message

- Uses different (more stable) variable to determine experiment trial length

- Participants now have to press "R" to begin, to ensure correct window focus

----------------------



This script was generated to help you run your memorability experiment based on the parameters you want. I hope this is useful to you! If you use the memorability scores or this script in any of your work, please cite: 



***



I've streamlined how the experiments are run here in comparison to the original Isola et al., 2011 study. This means there are some differences for the sake of making this easier to handle. Major differences include:



- Participants can no longer pause, exit, and start again later (since you'd need to maintain a database of their information somewhere!)

- Breaks are fixed time - participants currently can't continue on their own (because of how Javascript's setTimeout works)

- There is no more practice run. Feel free to make a mini experiment to use as a practice run.

- There is no feedback for button presses.



The output you will get are four variables:

 1. imseq: The order of image files shown to participants. Make sure you have no duplicate file names!! (Even if they're in different directories.)

 2. imtypeseq: The order of trial types.

 		0 = Fixation trial

 		1 = First presentation of a target image

 		2 = Second presentation (target repeat) of a target image

 		3 = First presentation of a filler image

 		4 = Second presentation (vigilance repeat) of a filler image

 3. perfseq: The order of participant behavior for each trial.

 		11 = hit

 		12 = miss

 		13 = false alarm

 		14 = correct rejection

 4. ending: Where the participant ended the study. If they finished, it will be set to "completed". If they failed, it will be set to "failed@" and the percentage of trials completed. If they stopped in the middle, it will be blank (but you will know the number of trials completed by the other variables).

 

One thing to keep in mind is that the most complex part of this script is optimizing the number of targets, fillers, timing, etc to maximize number of memorability scores and minimize the cost of the experiment. I have a beginning formula here that will give a good estimate but there may be more complicated designs you could imagine implementing (for example, adding more vigilance repeats or more target repeats dynamically and intelligently if there are not enough fillers). Feel free to try your hand at this -- you could even hard-code the image sequence yourself here instead of having it automatically calculated if you want complete control over everything!



Also keep in mind that these scripts don't necessarily account for human error. You may need to get more hits than the # calculated because people will often fail / quit in the middle.



Lastly, this script can be used as-is with Amazon Mechanical Turk, but you will have to implement your own server-side saving mechanism if you want to host it on your own website. The main values to save in the database can be find in the hidden input tags near the end of this script. If you'd like a tutorial on this, contact me and I'll write one up for people to use.



Let me know if you'd like anything added / changed: brainbridgelab@gmail.com. I will not be very actively updating these scripts, but if I get enough requests for a feature or change, I will likely implement it!



*/





// parameters set by the experimenter

var fixation_address = "http://www.wilmabainbridge.com/datasets/memorabilitycollector/fixation.jpg";

var images = new Array("https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_jqrTJzx8mWpHAA3","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_xcH1GFQiszsmeYx","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_fpJigcLK7OW83io","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_zEgMrabiEEArpzx","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_930RHM9JpWDfVNq","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_RCmWKBY6RdGpXmJ","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_XuvJQzhevcrjLNo","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_pGJglrYdZFPIiGE","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_h4E6EqA5HPj94gD","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_upfXxPNZIvEOwX7","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_KmqOdOrtA6kSsxk","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_V0zZiIWD7drDpCq","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_MzaZzXg3GXBeH9G","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_30eQ9TfW9RMQKrl","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_dYzuyegkSHvyXXD","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_ZC2sPPEYKYb8ll9","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_KdaL0UtVsjbiPkT","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_7ItuFxffwDGId0N","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_i8JLcSyBg4rEKov","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_UWVonhtrbPAuj2H","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_sBvUSGLcGO3HwwY","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_7raJZrLNdXhkcai","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_OD8qgJKvM3FO9iO","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_ZYJoARin9Nc2N4C","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_rTGnZC3AJttX5en","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_hDxFKcykuQWp1eu","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_ELe2OVvZCV1UHSl","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_WcIYHHUT0Ri5ebF","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_WliRc61qxUT68rF","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_1Q8kkM1aODtUxs3","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_BagfzHZBgMjfUdO","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_IxW1WVuzptV47YV","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_nBvalqWcwYZBqBc","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_hGYZVa37lhImgDl","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_FQmSUCVbEzbi8Kq","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_2RGBbVLXK147Kly","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_F8V6tgRCUli6Tmd","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_E9MDr0AgFhnVamP","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_YuyZ2Whv86KKyRq","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_O3oMqGL5dK2cfCv","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_dDriqJCY04P1FkT","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_yq0qkEybbWjNRPq","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_oK7fOtD5d4Vh5FL","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_2VgzFHWt2DJiESy","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_9VurQ0E7pvbe8lx","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_kQhKul25Y4UaE6s","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_8Cf0wY2nlUgCC3Y","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_Ld8fzkJXsx5kajk","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_EoeeWDbRECAio4u","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_jVCWjd24WVJO4Ob","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_RGavYpb2Eea2BUj","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_0U6baJ3osQwp67M","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_phyfSco9r2mOvZd","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_OCOqZDMK8uqFSkW","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_Ygz3KKlKpcvRaSD","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_z5yayJu0i7M3VBU","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_iaBAEFGzCTYbJfl","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_48DS2QtCoLGK7lh","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_LXeDpExMtlrTMTH","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_cV6ZR21fC9AZZ2O","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_OsfHGhKqXF8eL68","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_w5zNOGZbp1LJCgC","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_r5f6XVVfxEEuwjL","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_Dok94y5qD7KkdMr","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_dgo5E9nVxR3EniQ","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_MoOvdr5mAwNmO5s","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_acsnpoCpSGkgmJt","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_Q5rDfiRZPjxCW5G","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_Biqb0k7LOaTTjkL","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_QD9VQchY2v5UfOJ","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_1uTyp9bzIjcybgx","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_aRszjca6USopH1e","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_ZQesIX3H5VLX1T9","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_8Hl8vY9y2MhVTZ2","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_7SCayW3b2991fY8","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_u5U2vFJv9jUS8wq","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_2vQLiaFttOFSvWh","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_38PvENitYkzzrt3","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_2ZLD9ClQupQWD6J","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_HHB6ZZYw5ND14cq","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_7lEosFLBaKqyRj3","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_WNhj6lPAg5quUU4","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_hJebF41bYfaTYuq","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_63sfR0rYIscTKCX","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_s8YeFWFa8m57NOp","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_h4r2wzDeuOYeG2p","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_62yfkoL4OqJzhKC","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_RXyJpxpHWT9s9pC","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_SkvcErG6f2nZ2Ml","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_8ip4dx1ihdnMtXE","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_OAMt76PzJEhzRIZ","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_430O2QeVSAUJQM3","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_q9FkgOBEn0O2Sqz","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_RAKfPinrsuoi9YG","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_4mGuxOdVGwx7RSD","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_3IX7IMXbvXpxu1f","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_dfkTEwufMn40owQ","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_gJqHsdXY055g6wV","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_6rLy2bP5n1vVvxe","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_ISfSCzmW0TXd5hQ","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_jrfzOmjzkkxDrcC","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_5iHrINgRwznwYW2","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_Wh29imqb1sxGp7U","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_rfUInb0l5iYPAWX","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_yz69ymKGacwsCff","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_BrNpfwlspVvQC7y","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_jrqHNt9fQ8ALoDt","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_p6LIEJ9CVW0BRwa","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_k9T8dT1sHz4rY1p","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_Ndp0zjeZq6PifCA","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_0K2YnePrYsP4jiD","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_YoY5caCS8MH13mf","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_tBC3WUeMx7EFfWE","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_4FrWmR44ivCCwCa","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_iAPQsbdATCTIQjp","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_J7r1ilkWkeixOC5","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_mFMXwWAkURaZlMT","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_F5KBnggfr6goJlR","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_3sYKpzzLRuKp23N","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_qnmY5YVIhe0E9Cw","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_U5xlUA0tIOqypvj","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_rDgtrwXeIu4HrwH","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_BzMnzIhhfXZvqPW","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_ItDDTjuYlM27fmy","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_gZPv8HfdDmxoUub","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_6V6AffV1qeBQrye","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_Y03jnmj8Fhpwxu2","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_yzpJkmzwhoqo9cW","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_Mtn3yQAATCB7bKU","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_3FWQfB4FxopQv0y","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_5GjlMfpmh11h7Pa","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_6wAP96SqfTzzHBN","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_09ZEr8h95E7XeJB","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_DJijduKG7bFq2xt","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_o5J7qm9jOeHineF","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_TwHeGzhrM1jY06T","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_rMLCavE3SzBUhYg","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_UCLWoUMQf5UJGNc","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_N3XvDzfb5ydflBI","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_xIEmrCRGVkYr6BP","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_r97QAles5LmdMMJ","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_cE6IGwfxwOIjPq3","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_sg1QCUqcb1UgdKf","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_OtSXztGhcFPFHsH","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_Kf2NHpgHiCL5I76","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_ZEqadW4cmpmM591","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_Db3HmfqSEIvLiET","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_QNuK9kRp9kX3MLD","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_nE5gaafMoVTjkg3","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_CryfjfMkCA2w4KW","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_ugmdjhKhHlgUgop","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_LNpOa0nMWMlVdLt","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_NyQ77bWsjLYXqT3","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_NifM0eRe5qhlHBC","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_Lk0FkJmJa9OUyNW","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_kznn2KfxEQnoBkw","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_C86vtHbzC7xIRPo","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_2MuuYpwrVFxIeE0","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_HgDAEJ1VepB0zHY","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_wZtb25yGDqFSrJC","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_LoX0NFvJyS6DQZV","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_FEwLKCCIeIBwUKU","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_IdiutPe2JAD6RU4","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_AgFag94YXk7m3tV","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_NT40giIcdHm3Elm","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_jdtThndG6eMGuax","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_Se0aKwKoW9nR61g","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_jXW5tVMIpoQzbWc","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_3vP2GIWNAoDmCwd","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_V1na2H535ZuZFTz","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_qK3pTidMYsCn8zo","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_uBJIA5jQ5MTieAf","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_LJu5airJMmhjPzP","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_AV8eSVu9BxxTv2L","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_b4nW05mJQTe1BYU","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_FVFtLIrQBUi2LHP","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_46BLGVm3TRl3GbG","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_FQXjry25TeAz2TD","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_5kMDRsj2ezjEJp0","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_ZRnTHxHBrNEY9wd","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_vAyFlcOIrqDLql1","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_xKsGVt6tJBRF3Jd","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_bLYL7bYq8VwXhpQ","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_Ez43IfKWd0m519R","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_FkcTKiR8jz3PDf2","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_94msXbncUnat3Uk","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_H7ai4UUhGHnKo8f","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_rAutCditJCOjn7F","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_KCBpGDN9Vdm36JJ","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_1kcFvjSd4X1pusk","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_QGD3aHYMzJiFTXr","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_WWH3ajUrFeyRpVX","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_hOkAkVxJfvuHmnA","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_xLqCw10mEaIUvIj","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_NWU5UXrwdjYMQSr","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_OegvMrpVSJCgcrQ","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_mCjSWf2pEq69LhL","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_eM5U290JNLsiwhG","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_laEYaa3A7Ybrz3d","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_aAuZZMOv0XSN1EH","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_9DIZ5MnLIEwyYOe","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_XQKufrrg6BafrF5","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_cXjW4y7FjJy6hPC","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_tubY9g3ak32KxJU","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_pQdNue6ICc3uxxG","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_g2stYHVs0T1j4qC","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_Ez1eoGHOpMDGKTX","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_oM6z9XvmNVykvFl","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_UkqBCySN5xGXFjI","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_U036E7LcuYrOZay","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_Mkw7khfHQz9jsat","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_Peylp1qeXD380hD","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_cRMpQaDVo4z4caz","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_gPeFMVX17Td2Hsu","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_43B1xCBu3nEfEQS","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_L4xj5bkljXWwOwM","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_yN6OeK114JCP90N","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_WlDPRn3PJZE80Ly","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_4xaWuHNSvSGCrPs","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_Sp8G1wXZtDJwvoR","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_RXHEjQC2EH5RLGQ","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_kehvZlT9h2Nzqum","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_CX1X0OlPMGZ8aKr","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_BCMdM7734ALYS2b","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_A61YJJp0HdK7J2w","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_xv1JlxtIHLiLsyv","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_Usd0ZxE3R3Y6fut","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_gYlTeXwVm3ocLfd","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_3daZ6oyZKKljxbL","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_chXYEHycK6jpUAt","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_aWmPdrWaBYZRpnt","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_rpPpTWIv4CpIsyr","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_lceyF5CzROeTDoU","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_7MijCL06IMZiqIl","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_kueH9SPUmPQxZb5","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_fLFhh7RolFquNQe","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_rFLz9TvqhtJMPaw","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_lRXIwTGcLDdbBbx","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_CQDtVj6wxKQFbWX","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_3fSi2IEhgQxxNF2","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_m7sghngeVBi8ASB","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_RT6j0bMEU09pXAF","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_PGVa7txN32epx1u","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_73KC6VbXzRixdAd","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_EGr6q2XCkyaKwER","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_8scBUbECCP1Tsrb","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_ZCgO16GFQpzfg2o","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_UGycJN9Iwbq6d9J","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_mSQcuuhFrgUQPeZ","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_hHcUg3GyteOAoIa","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_2R9g1urKTRtpYCx","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_StaEKloN24mL2ET","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_jZ9urXKO57eRFgb","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_qEyysv8tZvXPfYS","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_BPqd5fROyVesxuG","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_lefZL3VsBudaIgU","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_XRVxwnoew0Va3Yd","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_lVn8SZDtDkVSLoX","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_og0PzdagMEgZ141","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_34gHSFoom6GVWR9","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_HzHe4a4UABbuJ6B","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_ssFt3jICPJZe1Jt","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_TxEBpV2DqHqg3JS","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_NdpMjfznyygu4UL","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_P009g9OQKzypA2r","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_a4Y0jBfCuq2AuoY","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_1WC8frPVCiNSK55","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_jQBK3vxYJ1SAgDW","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_PN5fDJprEuzwXZk","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_bVHXFJwBXu41v3c","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_EhPG9mcfIEQCLsO","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_cF7W5pAgXLmQVsA","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_JvQrKA29c3q0MPu","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_ldQfC9RAPrnMHJG","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_a6zkdBkwME0Mqjq","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_AiIU5dU5HST6cZQ","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_kSfELMsoV7TimFt","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_HMo19uRozhloNux","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_Mnv3XclCL60WuqR","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_ylAsKISfsljViED","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_1TztevlC5sMkwvN","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_RURmyXhH5zUx9nO","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_r71ThmvbkcUmNid","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_7jJCMYv9DtHKTPR","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_cF6m7qX8KU2uemg","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_uj72AZ67VlWwFJ3","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_Cz6z1nHEhF4rG4x","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_8TRPunsDkRi9jyH","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_OhN1xx2sH30oYfw","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_8eLPYwy7eQMKUD3","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_Pg1cHnIR4r681rY","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_nDLg7HfB9exNpLF","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_wswgAwl9IiRqamv","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_jAZIFG1BCKwwyUE","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_PtEYXWYeRx7ixVi","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_CCYlJTKWsJL4nqa","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_TDEpo8DDe53ZVcY","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_ioCOuaMdu22Kgop","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_GyPOsLlBUqcHSU2","https://neu.co1.qualtrics.com/ControlPanel/File.php?F=F_grqjm4jjzQUmeFd");

var stimtime = 1400; // in milliseconds

var isi = 1200; // in milliseconds

var delayBetTargets = 120; // in seconds

var delayBetVigilance = 5; // in trials. The size of image blocks

var keytoWatch = "r"; // case doesn't matter

var subsperim = 20; // how many subjects you want per image

var payperhour = 5; // how much money you want to pay per hour

var vigilancecutoff = 10; // the number of vigilances they're allowed to fail before being booted

var facutoff = 20; // the number of false alarms they're allowed to make before being booted

var timeBetweenBreaks = 300; // in seconds

var maxBreakTime = 300; // in seconds 



// text set by the experimenter

var failuretext = "<h2>Finished!</h2>Unfortunately you made too many errors and the game has ended. Press the <b>SUBMIT HIT</b> button to get credit for the hit.<br>";

var donetext = "<h2>Finished!</h2>You have finished the task - great job! Press the <b>SUBMIT HIT</b> button to get credit for the hit.<br>";



// global variables that are calculated later based on parameters

var trialsBetTargets = 30; // in num trials

var numfoils = 0;

var numtargets = 0;

var numtotalsubs = 0;

var allc = 0; // overall sequence counter when building the sequence

var experimentlength = 0;

var paypersub = 0;

var totalpay = 0;

var trialsBetweenBreaks = 0;



// full image sequence variables (these are the whole stream, with fixations built in)

// deal with these for when running the experiment

var fullsequence = []; // the sequence of everything (images plus fixation)

var timesequence = []; // the sequence of the timings

var typesequence = []; // the sequence of the image types

var perfsequence = []; // the sequence of the performance

var breakCounter = 0;



// image-only sequence variables (the ordering without fixation or anything extra you add in)

// deal with these when designing the stimulus presentation

var imtypeseq = []; // the sequence of the image types

var allimgseq = []; // the sequence of all the images

var performanceseq = []; // the sequence of performance

var imCount = -1; // trial number that is being shown. Starts from -1 because of setTimeOut quirks



// tracking performance (to determine if they can continue)

/* NOTE: This could be implemented in several different ways. For now I will do it as kicking someone out if they reach a certain number of failures, though you could imagine many other ways: 1) do it based on proportion of failures, 2) resetting if they get something right, 3) kicking out based on back-to-back failures, etc. You can try fiddling with determineFailure() to implement your own method!

*/

var vigilancefails = 0;

var falsealarmcounts = 0;

var kickedOut = 0;



// output variables

var imgstring = "";

var imtypestring = "";

var perfstring = "";



// ID constants for image type

const FIXATION = 0;

const TARGET = 1;

const REPEAT = 2; // target repeat

const FILLER = 3;

const VIGILANCE = 4; // vigilant repeat



// ID constants for performance

const HIT = 11;

const MISS = 12;

const FALSEALARM = 13;

const CORRECTREJECTION = 14;



/****************************************Functions*****************************************/



// key press listener

document.onkeydown = function(key){ processResponse(key);};



// preload and then start

function buttonPress(){

	// disable the Start Button once started

	document.getElementById("startbutton").innerHTML = "Experiment Running...";

	document.getElementById("startbutton").disabled = true;

	// now start the experiment

	preloadEverything();

	document.getElementById("performancerecord").innerHTML = "Press the <b>R key</b> to start. If it doesn't work, make sure to click in this browser window first.";

}



// recursive function that shows the images in a sequence

function animateSequence(){



	// save the performance of the previous trial

	saveProgress();

	

	// check if they've failed too much

	determineFailure();

	if (kickedOut){

		showFailure();

		return;

	}

	

	// check if it's time for a break

	if (breakCounter >= trialsBetweenBreaks) {

		giveBreak(0);

		breakCounter = -1;

		return;

	}

	breakCounter++;

	

	imCount++; // have to increment before the trial because of setTimeOut

	if (imCount == fullsequence.length){

		showEnding();

		return;

	}

	document.getElementById("stimulus").src = fullsequence[imCount];

	

	setTimeout("animateSequence()", timesequence[imCount]);

}



// preload and calculate everything

function preloadEverything() {

	calculateProps(); // calculate target and filler proportions

	/* NOTE: If you decide to manually separate the targets and foils, set their amounts here to 

	override what was calculated in calculateProps(). We still need to run calculateProps() for other values.

	For example:

		numtargets = 100;

		numfoils = 500;

	*/

	makeImSequence(); // get the image order

	calculateTotalPay(); // calculate payment

	buildFullSequence(); // build the sequence with the images and fixation

	// document.getElementById("startbutton").disabled = false;

}



// allows the participant to take a break

function giveBreak(going){

	if (going){

		document.getElementById("performancerecord").innerHTML = '';

		setTimeout("animateSequence()", timesequence[imCount])

		return;

	}

	document.getElementById("stimulus").src = fixation_address;

	document.getElementById("performancerecord").innerHTML = '<h2>Break time!</h2>Good job - you will now get a break. Please do not break for longer than ' + maxBreakTime + ' seconds or the HIT will continue without you. Press "<b>C</b>" to continue.';

	

	setTimeout("giveBreak(1)", maxBreakTime*1000);

}



// builds the full sequence with both images and fixations, as well as timings

function buildFullSequence(){

	var i = 0;

	var imcounter = 0;

	while (i < imtypeseq.length*2){

		// add an image

		fullsequence[i] = images[allimgseq[imcounter]]; // get the image in that order

		typesequence[i] = imtypeseq[imcounter];

		timesequence[i] = stimtime;

		perfsequence[i] = performanceseq[imcounter];

		i++;

		imcounter++;

		

		// add a fixation

		fullsequence[i] = fixation_address;

		typesequence[i] = FIXATION;

		timesequence[i] = isi;

		perfsequence[i] = FIXATION;

		i++;

	}

	console.log("Done building the full sequence.");

}



// get the key and respond

function processResponse(key){

	if(String.fromCharCode(key.keyCode).toLowerCase() == keytoWatch.toLowerCase()){ // if they pressed the desired key

		var trialtype = typesequence[imCount];

		if (imCount<0) { // they're pressing to start

			document.getElementById("performancerecord").innerHTML = "";

			animateSequence();

		}

		if ((trialtype == FIXATION) && imCount > 0) { // if it's fixation, get their response for the prior trial

			trialtype = typesequence[imCount-1];

		}

		if (trialtype == REPEAT | trialtype == VIGILANCE) { // they correctly pressed the button!

			perfsequence[imCount] = HIT;

			console.log("Hit!");

		} else if (trialtype == TARGET | trialtype == FILLER) { // they shouldn't have pressed

			perfsequence[imCount] = FALSEALARM;

			console.log("False alarm!");

		}

	}

}



// decide if they've failed too much

function determineFailure(){

	if (perfsequence[imCount] == FALSEALARM){

		falsealarmcounts++;

		console.log("False alarm count: " + falsealarmcounts);

	}

	if (falsealarmcounts >= facutoff){ // they've false alarmed too often!

		kickedOut = 1;

	}

	

	if (perfsequence[imCount] == MISS & typesequence[imCount] == VIGILANCE){

		vigilancefails++;

		console.log("Vigilance miss count: " + vigilancefails);

	}

	if (vigilancefails >= vigilancecutoff){

		kickedOut = 1;

	}

}



// visually show their failure!

function showFailure(){

	document.getElementById("performancerecord").innerHTML = failuretext;

	propcompleted = imCount/fullsequence.length*100;

	propcompleted = propcompleted.toFixed(2); // round to 2 decimal places

	document.getElementById("endingout").value = "failed@" + propcompleted + "%";

}



// end the game if they make it to the end!

function showEnding(){

	document.getElementById("performancerecord").innerHTML = donetext;

	document.getElementbyId("endingout").value = "completed";

}



// create the memorability-based image sequence

function makeImSequence(){



	/* NOTE: This code assumes you want to get the memorability scores of all of your images. If you instead have images you already know will be sorted as target vs. filler, you can edit that here. To do that:

		1. Input images as targets followed by fillers (in the textbox list of images in the other frame, or at the top with var images = ...

		2. Set numtargets to your number of targets

		3. Remove allImArray = shuffleArray(allImArray).

	The reason I haven't implemented this is because this depends on you choosing a good number of targets and fillers (rather than me calculating it for you here) and so it takes some thought

	*/



	var allImArray = populateArray(0, images.length);

	allImArray = shuffleArray(allImArray); // Comment this if you want to manually determine the targets and fillers

	var targetIms = allImArray.slice(0, numtargets);

	var fillerIms = allImArray.slice(numtargets, allImArray.length);

	var imblock = [];

	var typeblock = [];

	var perfblock = [];



	targetIms = shuffleArray(targetIms);

	repeatIms = shuffleArray(targetIms);

	fillerIms = shuffleArray(fillerIms);

	

	tc = 0; // target counter

	fc = 0; // filler counter

	ofbc = 0; // old filler block counter

	rc = 0; // repeat counter

	allc = 0; // overall sequence counter

	

	// now make pseudorandomized image blocks of 4 trials each

	oldfillblock = [];

	

	while (rc < repeatIms.length & fc < fillerIms.length){

		var c = 0; // mini-block counter

		

		if (tc < targetIms.length) { // TRIAL 1: a new targets (if there are still new ones to add)

			imblock[c] = targetIms[tc]; 

			typeblock[c] = TARGET;

			perfblock[c] = CORRECTREJECTION; // default: no response means CR

			tc++; c++; allc++;

		} else { // if we're out of new targets, put in a regular filler

			imblock[c] = fillerIms[fc];

			typeblock[c] = FILLER;

			perfblock[c] = CORRECTREJECTION; // default: no response means CR

			oldfillblock[ofbc] = fillerIms[fc];

			c++; allc++; ofbc++; fc++;

		}

	

		if (oldfillblock.length > 0) { // TRIAL 2: vigilance repeat from the last block

			oldfillblock = shuffleArray(oldfillblock);

			imblock[c] = oldfillblock[0];

			typeblock[c] = VIGILANCE;

			perfblock[c] = MISS; // default: no response means they missed it

			c++; allc++;

			oldfillblock = []; ofbc = 0;

		} else { // if there was no last block, put in a regular filler

			imblock[c] = fillerIms[fc];

			typeblock[c] = FILLER;

			perfblock[c] = CORRECTREJECTION;

			oldfillblock[ofbc] = fillerIms[fc]; 

			c++; allc++; ofbc++; fc++;

		}

	

		if (allc > trialsBetTargets) { // TRIAL 3: if enough delay has passed, can do target repeats

			imblock[c] = repeatIms[rc];

			typeblock[c] = REPEAT;

			perfblock[c] = MISS;

			rc++; c++; allc++;

		} else{ // if it's not time for the target repeats yet, put in a regular filler

			imblock[c] = fillerIms[fc];

			typeblock[c] = FILLER;

			perfblock[c] = CORRECTREJECTION;

			oldfillblock[ofbc] = fillerIms[fc]; 

			c++; allc++; ofbc++; fc++;

		}

	

		for (var i = 0; i < delayBetVigilance-3; i++){ // remaining trials: filler

			if (fc < fillerIms.length) { // only if there are fillers left to fill

				imblock[c] = fillerIms[fc]; 

				typeblock[c] = FILLER;

				perfblock[c] = CORRECTREJECTION;

				oldfillblock[ofbc] = fillerIms[fc];

				c++; allc++; ofbc++; fc++;

			}

		}

		

		[imblock, typeblock, perfblock] = shuffleArrays([imblock, typeblock, perfblock]);

		

		allimgseq = allimgseq.concat(imblock);

		imtypeseq = imtypeseq.concat(typeblock);

		performanceseq = performanceseq.concat(perfblock);

	

	}

	

	console.log("Done making the image sequence!");

}



// calculate the proportions of targets and foils

function calculateProps(){

	var trialtime = stimtime + isi;

	trialsBetTargets = Math.floor(delayBetTargets*1000 / trialtime);

	var B = trialsBetTargets;

	var S = delayBetVigilance;

	var C = images.length;

	

	numfoils = (S-1 + (S-2)*(C+(B/S)-1)-(B/S))/(S-1); // derived formula for how many foils you can have that satisfy your constraints

	

	/* Derivation comes from this:

	variables:

	C = # images, T = # targets, F = # foils, S = number of trials per block, B = minimum # of trials between targets

	abbreviations:

	t = target, f = foil, v = vigilance repeat, r = target repeat

	

	F = (first block is 1 t, the rest f) + (blocks before r starts is 1 t, 1 v, the rest f) + (remaining blocks are 1 t, 1 v, 1 r, the rest f) + (except for blocks when you're not showing any new t, put back a f to fill that space)

	F = (S-1) + (S-2)(B/S - 1) + (S-3)(T) + (T - B/S)		C = T + F

	F = (S-1) + (S-2)(B/S - 1) + (S-3)(C-F) + (C-F - B/S)

	...

	F = (S-1 + (S-2)(C + B/S - 1) - B/S)/(S-1)

	

	*/

	numtargets = C - numfoils;

	

	numfoils = Math.floor(numfoils);

	numtargets = Math.ceil(numtargets);

	

	// calculate how many subjects will be needed total

	var proptargets = C / numtargets * subsperim;

	

	// calculate how many trials before a break

	trialsBetweenBreaks = Math.ceil(timeBetweenBreaks*1000/trialtime);

	

	console.log("Calculated the proportions of images.");

}



// calculate the total pay for the whole study

function calculateTotalPay(){

	// calculate how many subjects will be needed total

	var proptargets = images.length / numtargets;

	numtotalsubs = proptargets * subsperim;

	

	experimentlength = (allc * (stimtime + isi)/1000)/60;

	paypersub = experimentlength/60 * payperhour;

	totalpay = paypersub * numtotalsubs;

	

	console.log("Calculated the pay amounts.");

}



function reportVariables(){

	var report = " With your " + images.length + " total images, if you want " + delayBetTargets + "s between target images,\n You will need " + numtargets + " targets and " + numfoils + " foils.\n This will result in an experiment that is " + experimentlength + "min long.\n To get " + subsperim + " subjects per target image, you will need " + numtotalsubs + " total subjects.\n At a rate of $" + payperhour + " per hour, each experiment will cost $" + paypersub + ",\n Or $" + totalpay + " for the whole study.";

	

	console.log(report)

}



// save to the output variables the performance and sequence completed so far

function saveProgress(){

	// get rid of the base address again just to shrink the length of the value

	if (imCount >= 0) {

		var tempimg = fullsequence[imCount];

		tempimg = tempimg.substring(tempimg.lastIndexOf("/")+1);

		if (imCount > 0) {

			imgstring = imgstring + ",";

			imtypestring = imtypestring + ",";

			perfstring = perfstring + ",";

		}

		imgstring = imgstring + tempimg;

		imtypestring = imtypestring + typesequence[imCount];

		perfstring = perfstring + perfsequence[imCount];

		document.getElementById("imseqout").value = imgstring;

		document.getElementById("imtypeseqout").value = imtypestring;

		document.getElementById("perfseqout").value = perfstring;

		}

}



/*************************************** General useful functions **********************************************/



// populate an array

function populateArray(start, end){

	array = [];

	for (var i = start; i < end; i++){

		array[i] = i;

	}

	return array;

}



// shuffle an array

function shuffleArray(array) {

    for (var i = array.length - 1; i > 0; i--) {

        var j = Math.floor(Math.random() * (i + 1));

        var temp = array[i];

        array[i] = array[j];

        array[j] = temp;

    }

    return array;

}



// shuffle multiple arrays with the same ordering (must all be same length)

function shuffleArrays(arrays){

	for (var i = arrays[0].length - 1; i > 0; i--) {

		var j = Math.floor(Math.random() * (i + 1));

		for (var an = 0; an < arrays.length; an++) {

			var temp = arrays[an][i];

			arrays[an][i] = arrays[an][j];

			arrays[an][j] = temp;

		}

	}

	return arrays;

}

			

// count the number of occurrences of a value in an array

function countOccurences(array, value){

	var counter = 0;

	for (var i = 0; i < array.length; i++){

		if (array[i] == value){

			counter++;

		}

	}

	return counter;

}





</script>

<body>



<form autocomplete="off">



<!--- These are the hidden variables that get outputted to AMT --->

<input type = "hidden" name = "imseq" id = "imseqout" value = "">

<input type = "hidden" name = "imtypeseq" id = "imtypeseqout" value = "">

<input type = "hidden" name = "perfseq" id = "perfseqout" value = "">

<input type = "hidden" name = "ending" id = "endingout" value = "">



<center>

<h1>Memory Test</h1>

	<table style="border:1px solid black"><tr>

	<td style="border:1px solid black"><center><p><span id = "instructions">You will see a stream of images. Press the <b>'r'</b> key any time you see an <b>image</b> you saw before. Press when you see the image and not during the '+'. If you make too many errors, the game will finish. This will take approximately 30 minutes.</span></p></center></td></tr>

	<tr><td height=450 width=450 style="vertical-align:middle"><center>

	<span id = "performancerecord">

	</span>

	<div id = "imagesequence"><img id = "stimulus" src = "http://www.wilmabainbridge.com/datasets/memorabilitycollector/fixation.jpg"></div>

	</center></td></tr></table>

<br>

<h3><button type = "button" id = "startbutton" onclick = "buttonPress()" autocomplete="off" style="border: 1px solid black; height:70; width:250; border-radius:12px">Click to Start</button></h3><br>

<p><span id = "consentinfo"></span></p>

<b>Click here to submit your HIT.</b> Only submit when completed, or you won't get full payment! If you decide to stop halfway, you can click this to end.<br><br>

<input type = "submit" id="submitbutton" name="Submit HIT" value="Submit HIT">

</center>

</form>

</body>
</html>
